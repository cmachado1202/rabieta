<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
     
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js"></script>


    <!-- Firebase -->
    <!-- Firebase v8.9.1 que utiliza CommonJS -->
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-storage.js"></script>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>

    <title>Formulario de Rendición</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
        crossorigin="anonymous">
        <style>
  body {
            background-color: #007bff;
            color: #ffffff;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-top: 20px;
        }

        h1, h2 {
            color: #007bff;
        }

        button {
            background-color: #0056b3;
            color: #ffffff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
            margin-bottom: 20px;
            font-size: 16px;
        }

        button:hover {
            background-color: #004080;
        }

        #fechaActual {
            margin-top: 10px;
        }

        .form-group {
            margin-top: 10px;
        }

        .form-group label {
            margin-bottom: 5px;
            text-align: left;
        }

        .form-group input {
            width: 100%;
        }

        .logo-container {
            margin-top: 20px;
            text-align: center;
        }

        .logo {
            width: 100px;
            height: auto;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        table, th, td {
            border: 1px solid #007bff;
        }

        th, td {
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #007bff;
            color: #ffffff;
        }

        .negro-texto {
            color: #000000 !important;
        }

        @media screen and (max-width: 600px) {
            .container {
                padding: 10px;
            }

            .logo-container {
                margin-top: 10px;
            }

            table, th, td {
                font-size: 12px;
            }

            .table-container {
                display: block;
            }
        }


            #tabla5-parte2.mostrar-campos tr:not(.mostrar) {
    display: none;
}

 

#tabla5-parte2.mostrar-completa table {
    display: table;
}

#tabla5-parte2.mostrar-campos tr:not(.mostrar) {
    display: none;
}

#tabla5-parte2.mostrar-completa tr {
    display: table-row;
}
#tabla0 input[type="number"][id^="legajo"],
#tabla1 input[type="number"][id^="Total"],
#tabla2 input[type="number"][id^="cantNotasCredito"],
#tabla2 input[type="number"][id^="cantTicketsAnulados"],
#tabla5-parte1 input[type="number"][id^="monto1"],
#tabla5-parte1 input[type="number"][id^="monto2"],
#tabla5-parte1 input[type="number"][id^="monto3"],
#tabla5-parte1 input[type="number"][id^="monto4"],
#tabla5-parte1 input[type="number"][id^="monto5"],
#tabla5-parte1 input[type="number"][id^="monto6"],
#tabla5-parte1 input[type="number"][id^="monto7"],
#tabla5-parte1 input[type="number"][id^="monto8"],

        #tabla3 input[type="number"][id^="cantidad"],
        #tabla4 input[type="number"][id^="cantidad"] {
            max-width: 6em; /* Ajustar el ancho máximo según tus necesidades */
        }
        #tabla3 input[type="number"][id^="total"]
        #tabla4 input[type="number"][id^="total"] {
            max-width: 10em; /* Ajustar el ancho máximo según tus necesidades */
        }
        #tabla5-parte2 input#Gastos,
#tabla5-parte2 input#mercadopago,
#tabla5-parte2 input#cantidadtickets,
#tabla5-parte2 input#promediodetickets,
#tabla5-parte2 input#totaltarjeta,
#tabla5-parte2 input#efectivoFinal,
#tabla5-parte2 input#fudex,
#tabla5-parte2 input#montorendir,
#tabla5-parte2 input#totalRendicion,
#tabla5-parte2 input#totales {
    max-width: 7em; /* O el ancho máximo que desees */
    /* Otros estilos si es necesario */
}




</style>

</head>

<body>
    <div class="container">
        <div class="logo-container">
            <img src="img/logo.jpg" alt="Logo" class="logo"> <!-- Ruta a tu logo -->
        </div>

        <h1>LA YUNGERE S.A</h1>
        <h2>Formulario de Rendición diaria</h2>
        <p id="fechaActual"></p>

        <script>
            function getFormattedDate() {
                const today = new Date();
                const dd = String(today.getDate()).padStart(2, '0');
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const yyyy = today.getFullYear();
                return dd + '/' + mm + '/' + yyyy;
            }

            document.getElementById('fechaActual').innerHTML = 'Fecha: ' + getFormattedDate();
        </script>
<div class="container">
    <!-- Tabla 0 -->
    <div id="tabla0" class="table-responsive">
        <table>
            <tr>
                <th>Nombre y Apellido</th>
                <th>Legajo</th>
            </tr>
            <tr>
                <td><input type="text" id="nombreApellido" name="nombreApellido" required></td>
                <td><input type="number" id="legajo" name="legajo" required></td>
            </tr>
        </table>
        <button onclick="mostrarSiguiente('tabla0', 'tabla1')">Siguiente</button>
    </div>

    <!-- Tabla 1 -->
    <div id="tabla1" class="table-responsive">
        <table>
            <tr>
                <th>Punto de Venta</th>
                <th>N° de Reporte Fiscal "Z"</th>
                <th>Cantidad de Tickets</th>
            </tr>
            <tr>
                <td><input type="text" id="puntoVenta1" name="puntoVenta1" class="form-control input-sm" required></td>
                <td><input type="text" id="reporteFiscal1" name="reporteFiscal1" class="form-control input-sm" required></td>
                <td><input type="number" id="cantidadTickets1" name="cantidadTickets1" class="form-control" required></td>
            </tr>
            <tr>
                <td><input type="text" id="puntoVenta2" name="puntoVenta2" class="form-control input-sm" required></td>
                <td><input type="text" id="reporteFiscal2" name="reporteFiscal2" class="form-control input-sm" required></td>
                <td><input type="number" id="cantidadTickets2" name="cantidadTickets2" class="form-control" required></td>
            </tr>
        </table>
        <button type="button" onclick="mostrarSiguiente('tabla1', 'tabla2')">Siguiente</button>
    </div>
    

    <!-- Tabla 2 -->
    <div id="tabla2" class="table-responsive">
        <form id="rendicionForm2">
            <!-- Primera tabla -->
            <table>
                <tr>
                    <th>Cantidad de Tickets Anulados</th>
                    <th>Total de Anulaciones</th>
                </tr>
                <tr>
                    <td><input type="number" id="cantTicketsAnulados" name="cantTicketsAnulados" required></td>
                    <td><input type="number" id="totalAnulaciones" name="totalAnulaciones" required></td>
                </tr>
            </table>
    
            <!-- Segunda tabla -->
            <table>
                <tr>
                    <th>Cantidad de Notas de Crédito</th>
                    <th>Total de Notas de Crédito</th>
                </tr>
                <tr>
                    <td><input type="number" id="cantNotasCredito" name="cantNotasCredito" required></td>
                    <td><input type="number" id="totalNotasCredito" name="totalNotasCredito" required></td>
                </tr>
            </table>
            
            <button type="button" onclick="mostrarSiguiente('tabla2', 'tabla3')">Siguiente</button>
        </form>
    </div>
    

    <!-- Tabla 3 -->
    <div id="tabla3" class="table-responsive">
        <form id="rendicionForm3">
            <table>
                <tr>
                    <th>Tarjetas de Débito</th>
                    <th>Cantidad</th>
                    <th>Total</th>
                </tr>
                <tr>
                    <td class="negro-texto">Visa Electron</td>
                    <td><input type="number" id="cantidadVisaElectron3" name="cantidadVisaElectron3" required></td>
                    <td><input type="number" id="totalVisaElectron3" name="totalVisaElectron3" required></td>
                </tr>
                <tr>
                    <td class="negro-texto">Maestro</td>
                    <td><input type="number" id="cantidadMaestro3" name="cantidadMaestro3" required></td>
                    <td><input type="number" id="totalMaestro3" name="totalMaestro3" required></td>
                </tr>
                <tr>
                    <td class="negro-texto">Mc Debit</td>
                    <td><input type="number" id="cantidadMcDebit3" name="cantidadMcDebit3" required></td>
                    <td><input type="number" id="totalMcDebit3" name="totalMcDebit3" required></td>
                </tr>
                <tr>
                    <td class="negro-texto">MODO</td>
                    <td><input type="number" id="cantidadModo3" name="cantidadModo3" required></td>
                    <td><input type="number" id="totalModo3" name="totalModo3" required></td>
                </tr>
            </table>
            <button type="button" onclick="mostrarSiguiente('tabla3', 'tabla4')">Siguiente</button>
        </form>
    </div>
 



        
            <!-- Tabla 4 -->
            <div id="tabla4" class="table-responsive">
                <form id="rendicionForm4">
                    <table>
                        <tr>
                            <th>Tarjetas de Crédito</th>
                            <th>Cantidad</th>
                            <th>Total</th>
                        </tr>
                        <tr>
                            <td class="negro-texto">Visa</td>
                            <td><input type="number" id="cantidadVisaElectron4" name="cantidadVisaElectron4" required></td>
                            <td><input type="number" id="totalVisaElectron4" name="totalVisaElectron4" required></td>
                        </tr>
                        <tr>
                            <td class="negro-texto">Mastercard</td>
                            <td><input type="number" id="cantidadMaestro4" name="cantidadMaestro4" required></td>
                            <td><input type="number" id="totalMaestro4" name="totalMaestro4" required></td>
                        </tr>
                        <tr>
                            <td class="negro-texto">Amex</td>
                            <td><input type="number" id="cantidadMcDebit4" name="cantidadMcDebit4" required></td>
                            <td><input type="number" id="totalMcDebit4" name="totalMcDebit4" required></td>
                        </tr>
                        <tr>
                            <td class="negro-texto">Cabal</td>
                            <td><input type="number" id="cantidadModo4" name="cantidadModo4" required></td>
                            <td><input type="number" id="totalModo4" name="totalModo4" required></td>
                        </tr>
                    </table>
                    <button type="button" onclick="mostrarSiguiente('tabla4', 'tabla5-parte1')">Siguiente</button>
                </form>
            </div>
        
            <!-- Tabla 5 (dividida en dos partes) - Parte 1 -->
            <div id="tabla5-parte1" class="table-responsive">
                <form id="rendicionForm5-parte1">
                    <table>
                        <tr>
                            <th>Gastos</th>
                            <th>Montos</th>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto1" name="monto1" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto2" name="monto2" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto3" name="monto3" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto4" name="monto4" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto5" name="monto5" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto6" name="monto6" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto7" name="monto7" required></td>
                        </tr>
                        <tr>
                            <td><input type="text" value=" " required></td>
                            <td><input type="number" id="monto8" name="monto8" required></td>
                        </tr>
                    </table>
                    <button type="button" onclick="mostrarSiguiente('tabla5-parte1', 'tabla5-parte2')">Siguiente</button>
                </form>
            </div>
        
            <!-- Tabla 5 (dividida en dos partes) - Parte 2 -->
            <!-- Agrega la clase "mostrar-campos" al cargar la página -->
            <div id="tabla5-parte2" class="table-responsive">
 

                <form id="rendicionForm5-parte2">
                    <table>
                        <tr class="ocultar">
                            <td><input type="text" value="Gastos" readonly></td>
                            <td><input type="number" id="Gastos" name="Gastos" readonly></td>
                        </tr>
                        <tr class="mostrar">
                            <td><input type="text" value="Mercadopago" readonly></td>
                            <td><input type="number" id="mercadopago" name="mercadopago" required></td>
                        </tr>


                        <tr class="ocultar">
                            <td><input type="text" value="Cantidad de ticktes" readonly></td>
                            <td><input type="number" id="cantidadtickets" name="cantidadtickets" readonly></td>
                        </tr>
                        <tr class="ocultar">
                            <td><input type="text" value="Promedio de tickets" readonly></td>
                            <td><input type="number" id="promediodetickets" name="promediodetickets" readonly></td>
                        </tr>
                        <tr class="ocultar">
                            <td><input type="text" value="total Tarjeta" readonly></td>
                            <td><input type="number" id="totaltarjeta" name="totaltarjeta" readonly></td>
                        </tr>
                        <tr class="mostrar">
                            <td><input type="text" value="Efectivo final" readonly></td>
                            <td><input type="number" id="efectivoFinal" name="efectivoFinal" required></td>
                        </tr>

                        <tr class="mostrar">
                            <td><input type="text" value="Fudex" readonly></td>
                            <td><input type="number" id="fudex" name="fudex" required></td>
                        </tr>
                        <tr class="ocultar">
                            <td><input type="text" value="Monto a Rendir" readonly></td>
                            <td><input type="number" id="montorendir" name="montorendir" readonly></td>
                        </tr>
                        <tr class="ocultar">
                            <td><input type="text" value="Total de rendición" readonly></td>
                            <td><input type="number" id="totalRendicion" name="totalRendicion" readonly></td>
                        </tr>
                        <tr class="ocultar">
                            <td><input type="text" value="Diferencia" readonly></td>
                            <td><input type="number" id="totales" name="totales" readonly></td>
                        </tr>
                    </table>
                    
                    
                    
                    <button type="button" onclick="realizarCalculosParte2()">Realizar Cálculos</button>
                    <button type="button" onclick="revisar()">Revisar</button>


               
                </form>
            </div>
        </div>
        
        <script>
            function revisar() {
        // Llama a la función para ir a la "Tabla 0"
        irATabla0();
    }

    function irATabla0() {
        // Implementa aquí la lógica para llevar al usuario a la "Tabla 0"
        // Por ejemplo, puedes ocultar todas las tablas y mostrar solo la "Tabla 0"
        ocultarTodasLasTablas();
        mostrarTabla("tabla0", "table");
    }
function ocultarTabla(tablaId) {
    const tabla = document.getElementById(tablaId);
    if (tabla) {
        tabla.style.display = 'none';
    }
}

function mostrarTabla(tablaId, displayValue = 'table') {
    const tabla = document.getElementById(tablaId);
    if (tabla) {
        tabla.style.display = displayValue;
    }
}

function ocultarTodasLasTablas() {
    ocultarTabla("tabla1");
    ocultarTabla("tabla2");
    ocultarTabla("tabla3");
    ocultarTabla("tabla4");
    ocultarTabla("tabla5-parte1");
    ocultarTabla("tabla5-parte2");
}

function mostrarSiguiente(tablaActual, tablaSiguiente) {
    ocultarTabla(tablaActual);
    mostrarTabla(tablaSiguiente);
}

function mostrarCamposMostrarTabla5Parte2() {
    var tabla5Parte2 = document.getElementById("tabla5-parte2");
    tabla5Parte2.classList.add("mostrar-campos");
    tabla5Parte2.classList.remove("mostrar-completa");
}

function mostrarTablaCompletaParte2() {
    var tabla5Parte2 = document.getElementById("tabla5-parte2");
    tabla5Parte2.classList.remove("mostrar-campos");
    tabla5Parte2.classList.add("mostrar-completa");
}

// Oculta todas las tablas al cargar la página
ocultarTodasLasTablas();

// Llama a la función al cargar la página
document.addEventListener("DOMContentLoaded", function () {
    ocultarTodasLasTablas();
    mostrarCamposMostrarTabla5Parte2();
});

// Resto de tu código...
// ...


//////////////////////////////////////////////////////////////
            function generarPDF() {
                // Crear instancia de jsPDF
                const pdf = new jsPDF();
        
                // Capturar el contenido visual de la página con html2canvas
                html2canvas(document.body).then(canvas => {
                    // Convertir el canvas a Blob
                    const imgData = canvas.toDataURL('image/png');
                    const pdfBlob = dataURItoBlob(imgData);
        
                    // Generar nombre único para el archivo PDF
                    const nombreArchivo = `rendicion_${new Date().getTime()}.pdf`;
        
                    // Obtener referencia al servicio de almacenamiento de Firebase
                    const storage = firebase.storage();
                    const storageRef = storage.ref();
        
                    // Subir el Blob a Firebase Storage
                    storageRef.child(nombreArchivo).put(pdfBlob).then(snapshot => {
                        console.log("PDF subido correctamente:", snapshot);
        
                        // Obtener la URL de descarga del PDF
                        storageRef.child(nombreArchivo).getDownloadURL().then(url => {
                            console.log("URL de descarga:", url);
                            alert("PDF generado y guardado en Firebase con éxito. URL de descarga: " + url);
        
                            // Abrir el diálogo de impresión
                            window.print();
                            limpiarCampos();    
                        }).catch(error => {
                            console.error("Error al obtener la URL de descarga:", error);
                        });
                    }).catch(error => {
                        console.error("Error al subir el PDF a Firebase Storage:", error);
                    });
                });
            }
        
            // Función para convertir data URI a Blob
            function dataURItoBlob(dataURI) {
                const byteString = atob(dataURI.split(',')[1]);
                const ab = new ArrayBuffer(byteString.length);
                const ia = new Uint8Array(ab);
                for (let i = 0; i < byteString.length; i++) {
                    ia[i] = byteString.charCodeAt(i);
                }
                return new Blob([ab], { type: 'image/png' });
            }
            
           
        </script>
        
        
            
        <button type="button" onclick="generarPDF()">Imprimir</button>
        
        </form>
        </div>
        <script>
         
         function calcularPromedio(tablaId, campoNombre) {
    try {
        var tabla = document.getElementById(tablaId);

        if (!tabla) {
            throw new Error("La tabla con ID '" + tablaId + "' no se encontró.");
        }

        var filas = tabla.querySelectorAll("tr");

        if (filas.length < 3) {
            throw new Error("La tabla debe tener al menos 3 filas para calcular el promedio.");
        }

        var sumaColumna2 = 0;
        var sumaColumna3 = 0;

        // Sumar los valores de la columna 2 y columna 3
        for (var i = 1; i < filas.length; i++) {
            var valorCelda2 = parseFloat(filas[i].querySelectorAll("td")[1].querySelector("input").value) || 0;
            var valorCelda3 = parseFloat(filas[i].querySelectorAll("td")[2].querySelector("input").value) || 0;

            sumaColumna2 += valorCelda2;
            sumaColumna3 += valorCelda3;
        }

        // Calcular el promedio
        var promedio = (sumaColumna3 !== 0) ? sumaColumna2 / sumaColumna3 : 0;

        // Anotar la suma de la columna 3 de la tabla 1 en la Tabla 5 parte 2, fila 2
        var tabla5Parte2 = document.getElementById("tabla5-parte2");
        var filasTabla5Parte2 = tabla5Parte2.querySelectorAll("tr");

        if (filasTabla5Parte2.length < 3) {
            throw new Error("La Tabla 5 parte 2 debe tener al menos 3 filas.");
        }

        filasTabla5Parte2[2].querySelectorAll("td")[1].querySelector("input").value = sumaColumna3;

        // Anotar el promedio en la Tabla 5 parte 2, fila 3
        filasTabla5Parte2[3].querySelectorAll("td")[1].querySelector("input").value = promedio.toFixed(2);
    } catch (error) {
        console.error(error.message);
    }
}


        
    function calcularSumaColumna4() {
    var tabla3 = document.getElementById("tabla3");
    var tabla4 = document.getElementById("tabla4");
    var tabla5Parte2 = document.getElementById("tabla5-parte2");

    if (!tabla3 || !tabla4 || !tabla5Parte2) {
        console.error("Error: No se encontraron algunas de las tablas.");
        return;
    }

    var filas3 = tabla3.querySelectorAll("tr");
    var filas4 = tabla4.querySelectorAll("tr");

    if (filas3.length < 2 || filas4.length < 2) {
        console.error("Las tablas deben tener al menos 2 filas para calcular la suma.");
        return;
    }

    var suma3 = 0;
    var suma4 = 0;

    for (var i = 1; i < filas3.length; i++) {
        var valorCelda3 = parseFloat(filas3[i].querySelectorAll("td")[2].querySelector("input").value);
        var valorCelda4 = parseFloat(filas4[i].querySelectorAll("td")[2].querySelector("input").value);

        if (!isNaN(valorCelda3)) {
            suma3 += valorCelda3;
        }

        if (!isNaN(valorCelda4)) {
            suma4 += valorCelda4;
        }
    }

    // Anotar la suma en la tabla5-parte2, columna 4, fila 4
    var filasTabla5Parte2 = tabla5Parte2.querySelectorAll("tr");

// Verificar si hay al menos 5 filas en la colección
if (filasTabla5Parte2.length >= 5) {
    // Acceder a la fila en la posición 4 (quinta fila)
    var fila4Tabla5Parte2 = filasTabla5Parte2[4];

    // Verificar si la fila existe
    if (fila4Tabla5Parte2) {
        // Acceder a la celda en la columna 2 (segunda celda)
        var celda2Tabla5Parte2 = fila4Tabla5Parte2.querySelectorAll("td")[1];

        // Verificar si la celda existe
        if (celda2Tabla5Parte2) {
            // Acceder al input dentro de la celda y asignar el valor
            celda2Tabla5Parte2.querySelector("input").value = suma3 + suma4;
        }
    }
}

            }
            function calcularSumaColumna2Tabla5() {
    try {
        var tabla5Parte1 = document.getElementById("tabla5-parte1");
        var tabla5Parte2 = document.getElementById("tabla5-parte2");

        if (!tabla5Parte1 || !tabla5Parte2) {
            throw new Error("Error: No se encontraron algunas partes de la tabla 5.");
        }

        var filas5Parte1 = tabla5Parte1.querySelectorAll("tr");
        var filas5Parte2 = tabla5Parte2.querySelectorAll("tr");

        if (filas5Parte1.length < 2 || filas5Parte2.length < 1) {
            throw new Error("Las partes de la tabla 5 deben tener al menos 2 filas para calcular la suma.");
        }

        var sumaColumna2Parte1 = 0;

        // Sumar los valores de la columna 2 en la parte 1
        for (var i = 0; i < filas5Parte1.length; i++) {
            var celda2Parte1 = filas5Parte1[i].querySelectorAll("td")[1];
            var valorCelda2Parte1 = celda2Parte1 ? parseFloat(celda2Parte1.querySelector("input").value) || 0 : 0;
            sumaColumna2Parte1 += valorCelda2Parte1;
        }

        // Anotar la suma en la tabla5 parte 2, fila 1
        var fila1Tabla5Parte2 = filas5Parte2[0];
        if (fila1Tabla5Parte2) {
            var celda1Tabla5Parte2 = fila1Tabla5Parte2.querySelectorAll("td")[1];
            if (celda1Tabla5Parte2) {
                celda1Tabla5Parte2.querySelector("input").value = sumaColumna2Parte1;
            }
        }
    } catch (error) {
        console.error(error.message);
    }
}





function sumarFilasTabla5Parte2() {
    try {
        // Obtener la tabla5 parte 2
        var tabla5Parte2 = document.getElementById("tabla5-parte2");

        if (!tabla5Parte2) {
            throw new Error("No se encontró la Tabla 5 parte 2.");
        }

        // Obtener los valores de las filas 0, 1, 4, 5 y 6
        var valorFila0 = parseFloat(tabla5Parte2.querySelectorAll("tr")[0].querySelectorAll("td")[1].querySelector("input").value) || 0;
        var valorFila1 = parseFloat(tabla5Parte2.querySelectorAll("tr")[1].querySelectorAll("td")[1].querySelector("input").value) || 0;
        var valorFila4 = parseFloat(tabla5Parte2.querySelectorAll("tr")[4].querySelectorAll("td")[1].querySelector("input").value) || 0;
        var valorFila5 = parseFloat(tabla5Parte2.querySelectorAll("tr")[5].querySelectorAll("td")[1].querySelector("input").value) || 0;
        var valorFila6 = parseFloat(tabla5Parte2.querySelectorAll("tr")[6].querySelectorAll("td")[1].querySelector("input").value) || 0;

        // Calcular la suma de los valores
        var sumaTotal = valorFila0 + valorFila1 + valorFila4 + valorFila5 + valorFila6;

        // Anotar la suma en la fila 9
        var fila9 = tabla5Parte2.querySelectorAll("tr")[8];
        if (fila9) {
            fila9.querySelectorAll("td")[1].querySelector("input").value = sumaTotal;
        }
    } catch (error) {
        console.error(error.message);
    }
}



function calcularDiferencia() {
    try {
        // clacula la diferencia del z y las notas de credito
        var tabla1 = document.getElementById("tabla1");
        var filasTabla1 = tabla1.querySelectorAll("tr");

        if (filasTabla1.length < 3) {
            throw new Error("La tabla 1 debe tener al menos 3 filas.");
        }

        // Obtener los valores de la tabla 2, parte 1
        var tabla2Parte1 = document.getElementById("tabla2").querySelectorAll("table")[0];
        var celda2Tabla2Parte1 = tabla2Parte1.querySelectorAll("tr")[1].querySelectorAll("td")[1];

        // Obtener los valores de la tabla 2, parte 2
        var tabla2Parte2 = document.getElementById("tabla2").querySelectorAll("table")[1];
        var celda2Tabla2Parte2 = tabla2Parte2.querySelectorAll("tr")[1].querySelectorAll("td")[1];

        // Verificar si hay al menos dos celdas en ambas partes de la tabla 2
        if (!celda2Tabla2Parte1 || !celda2Tabla2Parte2) {
            console.error("Las partes de la tabla 2 deben tener al menos 2 celdas.");
            return;
        }

        // Calcular la diferencia solo si hay valores definidos
        var restarTabla2 = parseFloat(celda2Tabla2Parte1.querySelector("input").value) || 0;
        restarTabla2 += parseFloat(celda2Tabla2Parte2.querySelector("input").value) || 0;

        // Si hay valores en tabla1, asumir cero en caso de null o undefined
        var totalTabla1 = 0;
        for (var i = 1; i < filasTabla1.length; i++) {
            var valorCelda1 = filasTabla1[i].querySelectorAll("td")[1].querySelector("input").value;
            totalTabla1 += parseFloat(valorCelda1) || 0; // Si es null o undefined, asumir cero
        }

        var diferencia = totalTabla1 - restarTabla2;

        // Anotar la diferencia en la tabla5 parte dos, columna 2, fila 8
        var tabla5Parte2 = document.getElementById("tabla5-parte2");
        var filasTabla5Parte2 = tabla5Parte2.querySelectorAll("tr");

        if (filasTabla5Parte2.length < 8) {
            throw new Error("La tabla5 parte dos debe tener al menos 8 filas.");
        }

        filasTabla5Parte2[7].querySelectorAll("td")[1].querySelector("input").value = isNaN(diferencia) ? 0 : diferencia;
    } catch (error) {
        console.error(error.message);
    }
}

function final() {
    try {
        // Obtener los valores de la fila 7 y fila 8 de la tabla5 parte dos
        var tabla5Parte2 = document.getElementById("tabla5-parte2");
        var filasTabla5Parte2 = tabla5Parte2.querySelectorAll("tr");

        if (filasTabla5Parte2.length < 9) {
            throw new Error("La tabla5 parte dos debe tener al menos 9 filas.");
        }

        var valorFila7 = parseFloat(filasTabla5Parte2[7].querySelectorAll("td")[1].querySelector("input").value) || 0;
        var valorFila8 = parseFloat(filasTabla5Parte2[8].querySelectorAll("td")[1].querySelector("input").value) || 0;

        // Calcular la diferencia entre fila 7 y fila 8
        var resultado = valorFila8 - valorFila7;

        // Anotar el resultado en la fila 9
        filasTabla5Parte2[9].querySelectorAll("td")[1].querySelector("input").value = isNaN(resultado) ? 0 : resultado;
    } catch (error) {
        console.error(error.message);
    }
}



////////////////////////////////////////////////////////////////////////////////////////////////////////
// Función para mostrar solo los campos con la clase "mostrar" al presentar la última tabla (Parte 2)


// Función principal para realizar cálculos y mostrar la tabla (Parte 2)
function realizarCalculosParte2() {
    // Realizar los cálculos
    calcularPromedio("tabla1", "promedio1");
    calcularSumaColumna4();
    calcularSumaColumna2Tabla5();
    sumarFilasTabla5Parte2();
    calcularDiferencia();
    final();

    // Obtener el elemento de la tabla 5 parte 2
    var tabla5Parte2 = document.getElementById("tabla5-parte2");

    // Mostrar la tabla completa
    tabla5Parte2.classList.add("mostrar-completa");
    tabla5Parte2.classList.remove("mostrar-campos");

    // Añadir mensajes de consola para depurar
    console.log("Cálculos realizados correctamente.");
    console.log("Tabla 5 parte 2 debería mostrarse completa.");
}









 
         
        
        <!-- Configuración de Firebase -->
         
          const firebaseConfig = {
            apiKey: "AIzaSyCNQCuLg1f1qK-MFDt3lMwa3q1YRyZMYu8",
            authDomain: "rendicion-4e38d.firebaseapp.com",
            projectId: "rendicion-4e38d",
            storageBucket: "rendicion-4e38d.appspot.com",
            messagingSenderId: "755023359161",
            appId: "1:755023359161:web:55b7da2a50c2ce1712bf68",
            measurementId: "G-ZMCCX6XRXF"
          };
        
          // Inicializa Firebase
          firebase.initializeApp(firebaseConfig);
        
          // También podrías inicializar otras partes de Firebase si las necesitas, por ejemplo, Firebase Storage
          // var storage = firebase.storage();
         
          
          function limpiarCampos() {
                // Obtener todos los campos de las tablas (utilizando clases)
                const camposTablas = document.querySelectorAll('.table-container input');
        
                // Limpiar el valor de todos los campos
                camposTablas.forEach(campo => campo.value = "");
            }
</script>

<!-- Bootstrap JS y Popper.js -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
     


</body>
 
</html>